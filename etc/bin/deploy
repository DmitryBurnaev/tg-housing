#!/bin/bash
set -e

export WORKING_DIR=/opt/tg-housing/

echo "=== reading $(pwd)/.env file ==="
export $(cat .env | grep -v ^# | xargs)

echo "=== pulling image ${DOCKER_IMAGE} ==="
docker pull ${DOCKER_IMAGE}

echo "=== restarting service ==="
systemctl restart tg-housing.service

echo "=== clearing ==="
echo y | docker image prune -a

echo "=== check status ==="
systemctl status tg-housing.service
docker ps | grep "tg-housing"
